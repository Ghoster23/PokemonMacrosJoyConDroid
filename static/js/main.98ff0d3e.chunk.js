(this["webpackJsonppoke-macros-joycondroid"]=this["webpackJsonppoke-macros-joycondroid"]||[]).push([[0],{10:function(e,t,a){e.exports=a(18)},16:function(e,t,a){},17:function(e,t,a){},18:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(9),o=a.n(s),i=a(1),c=a(2),u=a(6),h=a(5),l=a(4),d=a(7),m=a(3),v=a.n(m),p=(a(16),0),y=1,f=2,g=3;function k(e,t){var a=-1;return e.forEach((function(e,n){e===t&&(a=n)})),a}function D(e){return e.toISOString().slice(0,10)}function b(e){var t;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=null,a.next=3,v.a.awrap(fetch(e).then((function(e){return e.json()})));case 3:return t=a.sent,a.abrupt("return",t);case 5:case"end":return a.stop()}}))}function w(e){var t={width:"".concat(e.percentage,"%")};return r.a.createElement("div",{className:"progress-bar"},r.a.createElement("div",{className:"filler",style:t}))}function M(e){return r.a.createElement("div",{key:e.ind,className:"key-log"},r.a.createElement("b",{className:"key-log-cell"}," ",e.pressedKey," "),r.a.createElement("b",{className:"key-log-cell"}," ",e.onTime," "),r.a.createElement("b",{className:"key-log-cell"}," ",e.offTime," "))}var S=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={},a.handleChange=a.handleChange.bind(Object(l.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleChange",value:function(e){""!==e.target.value?this.props.onChange(e.target.value):this.props.onChange(D(new Date))}},{key:"render",value:function(){return r.a.createElement("input",{type:"date",className:"date-input",readOnly:this.props.readonly,value:this.props.date,onChange:this.handleChange})}}]),t}(r.a.Component),E=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={active:!1,locked:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t="",a=!this.props.active||this.props.locked,n=this.props.parameters;switch(this.props.macro){default:break;case 0:t=r.a.createElement("div",{className:"macro-parameters",id:"TimeSkipParams"},r.a.createElement("label",{className:"parameter"},"Start Date",r.a.createElement(S,{id:"startDate",name:"start-date",date:n.startDate,onChange:function(t){return e.props.eventHandler("startDate",t)},readonly:a})),r.a.createElement("label",{className:"parameter"},"End Date",r.a.createElement(S,{id:"endDate",name:"end-date",date:n.endDate,onChange:function(t){return e.props.eventHandler("endDate",t)},readonly:a})));break;case 1:case 2:return r.a.createElement("div",{className:"macro-parameters",id:"TimeSkipParams"})}return t}}]),t}(r.a.Component);var j=function(){function e(){Object(i.a)(this,e),this.filenames={FstSkipD:"FirstSkipDay.json",FstSkipM:"FirstSkipDayMonth.json",FstSkipY:"FirstSkipDayMonthYear.json",AdvDay:"AdvanceDay.json",AdvMonth:"AdvanceMonth.json",AdvYear:"AdvanceYear.json",AdvYearLp:"AdvanceYearLeap.json",AdvDec:"AdvanceDecember.json"},this.loaded={FstSkipD:"",FstSkipM:"",FstSkipY:"",AdvDay:"",AdvMonth:"",AdvYear:"",AdvDec:"",AdvYearLp:"",count:8},this.loadedCount=0,this.loadConcluded=!1,this.daysInMonth=[31,29,31,30,31,30,31,31,30,31,30,31],this.startDate=0,this.endDate=0,this.currentDate=0,this.macro=0,this.macroJSON=[];var t=["FstSkipD","FstSkipM","FstSkipY","AdvDay","AdvMonth","AdvYear","AdvYearLp","AdvDec"];for(var a in t)this.loadMacro(t[a])}return Object(c.a)(e,[{key:"loadMacro",value:function(e){var t;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=this.filenames[e],a.next=3,v.a.awrap(b("./macros/"+t));case 3:this.loaded[e]=a.sent,this.loadedCount+=1,this.loadedCount===this.loaded.count&&(this.loadConcluded=!0);case 6:case"end":return a.stop()}}),null,this)}},{key:"getMacro",value:function(e){return JSON.parse(JSON.stringify(this.loaded[e]))}},{key:"concatToMacro",value:function(e){this.macroJSON=this.macroJSON.concat(e)}},{key:"isLeapYear",value:function(e){return e%4===0&&(e%100!==0||e%400===0)}},{key:"AdvanceDay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.getMacro("AdvDay");return t.count=e,t}},{key:"AdvanceMonth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:31,t=this.getMacro("AdvMonth"),a=t[0];return a.count=e,t[0]=a,t}},{key:"InitMacro",value:function(){this.startDate.getMonth()<this.currentDate.getMonth()?this.startDate.getFullYear()<this.currentDate.getFullYear()?this.concatToMacro(this.getMacro("FstSkipY")):this.concatToMacro(this.getMacro("FstSkipM")):this.concatToMacro(this.getMacro("FstSkipD"))}},{key:"NextMacroStep",value:function(){var e=this.currentDate.getFullYear(),t=this.currentDate.getMonth(),a=this.currentDate.getDate(),n=this.endDate.getFullYear(),r=this.endDate.getMonth(),s=this.endDate.getDate(),o=0;if(e===n)if(t===r)o=s-a,this.concatToMacro(this.AdvanceDay(o)),this.currentDate.setDate(a+o);else if(1===a)for(var i=t;i<r;i++)o=this.daysInMonth[i],this.macro.concat(this.AdvanceMonth(o)),this.currentDate.setDate(a+o);else o=this.daysInMonth[t]-a+1,this.macro.concat(this.AdvanceMonth(o)),this.currentDate.setDate(a+o);else if(1===a)if(0===t)this.isLeapYear(e)?(this.concatToMacro(this.getMacro("AdvYearLp")),this.currentDate.setDate(a+366)):(this.concatToMacro(this.getMacro("AdvYear")),this.currentDate.setDate(a+365));else if(11===t)this.concatToMacro(this.getMacro("AdvDec")),this.currentDate.setDate(a+31);else for(var c=t;c<11;c++)o=this.daysInMonth[c],1!==c||this.isLeapYear(e)||(o-=1),this.concatToMacro(this.AdvanceMonth(o)),this.currentDate.setDate(a+o);else if(11===t){var u=this.getMacro("AdvDec"),h=u[0];h.count=31-a,u[0]=h,this.concatToMacro(u)}else o=this.daysInMonth[t]-a,this.concatToMacro(this.AdvanceMonth(o)),this.currentDate.setDate(a+o)}},{key:"build",value:function(e,t){if(!this.loadConcluded)return null;for(this.macroJSON=[],this.startDate=new Date(e),this.endDate=new Date(t),this.currentDate=new Date(e),this.currentDate.setDate(this.currentDate.getDate()+1),this.InitMacro();this.currentDate<this.endDate;)this.NextMacroStep();return this.macro=new P("Time Skip","./images/timeskip_icon.png",this.macroJSON),this.macro}}]),e}(),T=function(){function e(){Object(i.a)(this,e),this.log=[],this.log_count=0,this.active=[],this.active_count=0}return Object(c.a)(e,[{key:"clear",value:function(){this.log=[],this.log_count=0,this.active=[],this.active_count=0}},{key:"pressKey",value:function(e,t){-1===k(this.active,e)&&(this.active[this.active_count]=e,this.active_count++,this.logKeyPress(e,t))}},{key:"logKeyPress",value:function(e,t){this.log[this.log_count]={key:e,onTime:t,offTime:""},this.log_count++}},{key:"releaseKey",value:function(e,t){if(this.active_count>0){var a=k(this.active,e);-1!==a&&(this.active.splice(a,1),this.active_count--,this.logKeyRelease(e,t))}}},{key:"logKeyRelease",value:function(e,t){for(var a=0;a<this.log_count;a++){var n=this.log[this.log_count-(a+1)];if(n.key===e&&""===n.offTime){n.offTime=t,this.log[a]=n;break}}}},{key:"update",value:function(e,t,a){t?this.pressKey(e,a):this.releaseKey(e,a)}},{key:"renderPressed",value:function(){var e=this.active.map((function(e,t){return r.a.createElement("div",{className:"pressedKey",key:e},e)}));return r.a.createElement("div",{id:"PressedKeys"},r.a.createElement("b",null," Pressed "),e)}},{key:"renderLogged",value:function(){var e=[];if(this.log_count>0)for(var t=0;t<Math.min(3,this.log_count);t++){var a=this.log[this.log_count-(t+1)];e.push(r.a.createElement(M,{key:"keylog_"+t,pressedKey:a.key,onTime:a.onTime,offTime:a.offTime}))}return r.a.createElement("div",{id:"KeyLogs"},e)}}]),e}(),P=function(){function e(t,a,n){var r;for(Object(i.a)(this,e),this.name=t,this.icon=a,this.state=p,this.onWait=!1,this.waitTimeout=null,this.runner=null,this.segments=n,this.totalSteps=0,this.currentOverallStep=0,r=0;r<this.segments.length;r++){var s,o=this.segments[r],c=0;for(s=0;s<o.macro.length;s++){c+=o.macro[s].count}this.totalSteps+=c*o.count}}return Object(c.a)(e,[{key:"progress",value:function(){return 0===this.totalSteps?0:this.currentOverallStep/this.totalSteps}},{key:"startRunner",value:function(){var e=v.a.mark((function e(){var t,a,n,r,s,o,i,c,u,h;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.currentOverallStep=0,t={state:this.state,abort:!1},a=0;case 3:if(!(a<this.segments.length)){e.next=66;break}n=this.segments[a],r=n.macro,s=n.count,o=0;case 8:if(!(o<s)){e.next=63;break}i=0;case 10:if(!(i<r.length)){e.next=60;break}case 11:if(this.state===y){e.next=20;break}return void(e.next=14);case 14:if(!(t=e.sent).abort){e.next=17;break}return e.abrupt("return");case 17:this.state=t.state,e.next=11;break;case 20:c=r[i],u={button:c.button,pressed:!0,time:0},h=0,h=0;case 24:if(!(h<c.count)){e.next=57;break}return u.pressed=!0,this.wait(Math.max(c.onTime,20)),u.time=c.onTime,e.next=30,u;case 30:if(!this.onWait){e.next=39;break}return void(e.next=33);case 33:if(!(t=e.sent).abort){e.next=36;break}return e.abrupt("return");case 36:this.state=t.state,e.next=30;break;case 39:return u.pressed=!1,this.wait(Math.max(c.offTime,20)),u.time=c.offTime,e.next=44,u;case 44:if(!this.onWait&&this.state!==f){e.next=53;break}return void(e.next=47);case 47:if(!(t=e.sent).abort){e.next=50;break}return e.abrupt("return");case 50:this.state=t.state,e.next=44;break;case 53:this.currentOverallStep++;case 54:h++,e.next=24;break;case 57:i++,e.next=10;break;case 60:o++,e.next=8;break;case 63:a++,e.next=3;break;case 66:return e.abrupt("return");case 67:case"end":return e.stop()}}),e,this)}));this.runner=function(e,t){var a=e.apply(t);return a.next(),function(e){return a.next(e)}}(e,this)}},{key:"wait",value:function(e){this.waitTimeout=setTimeout(this.resume,e,this),this.onWait=!0}},{key:"resume",value:function(e){e.onWait=!1}},{key:"reset",value:function(){this.state=p,this.onWait&&(this.onWait=!1,clearTimeout(this.waitTimeout),this.waitTimeout=null),this.currentOverallStep=0,null!==this.runner&&(this.runner({state:this.state,abort:!0}),this.runner=null)}}]),e}(),A=function(){function e(){Object(i.a)(this,e),this.state={selectedMacro:0,playState:0,macroProgress:0,loadConcluded:!1};var t=new Date,a=new Date;a.setDate(a.getDate()+1),this.parameters={startDate:D(t),endDate:D(a)},this.macroBuilders=[],this.macroBuilders[0]=new j,this.macroParamsDirty=[!1],this.macros=Array(this.macroBuilders.length).fill(null)}return Object(c.a)(e,[{key:"checkLoadConcluded",value:function(){for(var e=!0,t=0;t<this.macroBuilders.length;t++){if(!this.macroBuilders[t].loadConcluded)return void(e=!1);null===this.macros[t]&&this.buildMacro(t)}this.state.loadConcluded=e}},{key:"selectMacro",value:function(e){if(this.state.selectedMacro!==e){new Audio("/click.mp3").play();var t=this.macros[this.state.selectedMacro];t.state!==p&&(t.reset(),this.state.playState=p,this.state.macroProgress=0),this.state.selectedMacro=e}}},{key:"changeParameter",value:function(e,t){switch(e){default:return;case"startDate":this.onStartDateChange(t),this.macroParamsDirty[0]=!0;break;case"endDate":this.onEndDateChange(t),this.macroParamsDirty[0]=!0}}},{key:"onStartDateChange",value:function(e){if(this.parameters.startDate!==e){var t=new Date(e),a=new Date(this.parameters.endDate);this.parameters.startDate=e,t>=a&&((a=new Date(t.getTime())).setDate(a.getDate()+1),this.parameters.endDate=D(a))}}},{key:"onEndDateChange",value:function(e){if(this.state.endDate!==e){var t=new Date(e),a=new Date(this.parameters.startDate);this.parameters.endDate=e,a>=t&&((a=new Date(t.getTime())).setDate(a.getDate()-1),this.parameters.startDate=D(a))}}},{key:"play",value:function(){var e=this.state.selectedMacro,t=this.macros[e];switch(t.state){default:case y:case f:break;case p:case g:if(t.state===g&&t.reset(),this.macroParamsDirty[e])this.macroParamsDirty[e]=!1,t=this.macroBuilders[e].build(this.parameters.startDate,this.parameters.endDate),this.macros[0]=t;t.startRunner()}return t.state=y,this.state.playState=y,!0}},{key:"pause",value:function(){var e=this.macros[this.state.selectedMacro];return e.state===y&&(e.state=f,console.log("paused"),this.state.playState=f,!0)}},{key:"reset",value:function(){var e=this.macros[this.state.selectedMacro];return e.state!==p&&(e.reset(),this.state.playState=p,this.state.macroProgress=0,!0)}},{key:"getMacroState",value:function(){return{macroState:this.state.playState,macroProgress:this.state.macroProgress}}},{key:"getMacrosRenderData",value:function(){for(var e=[],t=0;t<this.macros.length;t++){var a=this.macros[t];e[t]={name:a.name,icon:a.icon,parameters:this.parameters}}return e}},{key:"buildMacro",value:function(e){var t=this.macroBuilders[e];switch(e){default:return;case 0:this.macros[0]=t.build(this.parameters.startDate,this.parameters.endDate)}}},{key:"updateMacros",value:function(){for(var e=0;e<this.macroBuilders.length;e++){this.macroParamsDirty[e]&&(this.buildMacro(e),this.macroParamsDirty[e]=!1)}}},{key:"update",value:function(){var e=void 0;if(this.state.loadConcluded||this.checkLoadConcluded(),this.state.loadConcluded){var t=void 0,a=this.macros[this.state.selectedMacro];if(void 0===a)return;switch(a.state){default:case p:case g:return;case y:case f:t=a.runner({state:a.state,abort:!1})}void 0!==t&&(void 0!==t.value&&(e=t.value),t.done&&(a.state=g)),this.state.playState=a.state,this.state.macroProgress=100*a.progress()}return e}}]),e}(),O=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={},a.onButtonEvent=a.onButtonEvent.bind(Object(l.a)(a)),a.parameterChange=a.parameterChange.bind(Object(l.a)(a)),a.macroPlayer=new A,a.keyLogger=new T,a.currentTime=0,a.state={selectedMacro:0,macroState:-1,macroProgress:0,locked:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.UpdateTimerId=setInterval((function(){return e.update()}),20)}},{key:"componentWillUnmount",value:function(){clearInterval(this.UpdateTimerId)}},{key:"update",value:function(){this.currentTime+=20;var e=this.macroPlayer.update(this.currentTime);this.setState(this.macroPlayer.getMacroState()),void 0!==e&&(this.handleSwitchKeys(e.button,e.pressed),this.keyLogger.update(e.button,e.pressed,e.time))}},{key:"onButtonEvent",value:function(e,t){var a=new Audio("/click.mp3");switch(t&&a.play(),e){default:return;case"play":this.macroPlayer.play();break;case"pause":this.macroPlayer.pause();break;case"reset":this.macroPlayer.reset()&&this.keyLogger.clear()}this.setState(this.macroPlayer.getMacroState())}},{key:"parameterChange",value:function(e,t){this.macroPlayer.changeParameter(e,t)}},{key:"handleSwitchKeys",value:function(e,t){void 0!==window.joyconJS&&("minus"===e&&window.joyconJS.onMinus(t),"left-stick"===e&&window.joyconJS.onLeftJoystickPressed(t),"up"===e&&window.joyconJS.onUp(t),"right"===e&&window.joyconJS.onRight(t),"down"===e&&window.joyconJS.onDown(t),"left"===e&&window.joyconJS.onLeft(t),"lsl"===e&&window.joyconJS.onLeftSL(t),"lsr"===e&&window.joyconJS.onLeftSR(t),"plus"===e&&window.joyconJS.onPlus(t),"a"===e&&window.joyconJS.onA(t),"b"===e&&window.joyconJS.onB(t),"x"===e&&window.joyconJS.onX(t),"y"===e&&window.joyconJS.onY(t),"rsl"===e&&window.joyconJS.onRightSL(t),"rsr"===e&&window.joyconJS.onRightSR(t),"right-stick"===e&&window.joyconJS.onRightJoystickPressed(t),"home"===e&&window.joyconJS.onHome(t))}},{key:"renderMacros",value:function(){var e=this;if(!this.macroPlayer.state.loadConcluded)return r.a.createElement("b",null," Loading ");for(var t=this.macroPlayer.getMacrosRenderData(),a=[],n=0;n<t.length;n++){var s=t[n],o=this.macroPlayer.state.selectedMacro===n,i={background:"white"};o&&(i={background:"black"}),a[n]=r.a.createElement("div",{key:"macro_"+n,className:"macro"},r.a.createElement("div",{key:"macroButton_"+n,className:"macro-button",id:s.name,style:i,onClick:function(t){return e.selectMacro(n)}},r.a.createElement("img",{className:"icon",src:s.icon,alt:"Icon"+s.name}),s.name),r.a.createElement(E,{key:"macroParams_"+n,active:o,locked:this.state.locked,macro:n,parameters:s.parameters,eventHandler:this.parameterChange}))}return a}},{key:"render",value:function(){var e=this,t=this.keyLogger.renderPressed(),a=this.keyLogger.renderLogged(),n=this.renderMacros();return r.a.createElement("div",{className:"App",style:{backgroundImage:"url(./images/background.png)"}},r.a.createElement("div",{className:"App-header"},r.a.createElement("img",{className:"icon",src:"./images/macro_app_icon.png",alt:"AppIcon"}),r.a.createElement("b",{className:"App-title",style:{color:"black"}}," POK\xc9MACROS ")),r.a.createElement("div",{id:"body"},n,r.a.createElement("div",{id:"Tracker"},r.a.createElement(w,{key:"progressbar",percentage:this.state.macroProgress}),r.a.createElement("div",{id:"KeyLogging"},t,a)),r.a.createElement("div",{id:"PlayerButtons"},r.a.createElement("button",{key:"reset",className:"player-button",id:"Reset",onMouseDown:function(t){return e.onButtonEvent("reset",!0)},onMouseUp:function(t){return e.onButtonEvent("reset",!1)},onTouchStart:function(t){return e.onButtonEvent("reset",!0)},onTouchEnd:function(t){return e.onButtonEvent("reset",!1)}},"Reset"),r.a.createElement("button",{key:"play",className:"player-button",id:"Play",onMouseDown:function(t){return e.onButtonEvent("play",!0)},onMouseUp:function(t){return e.onButtonEvent("play",!1)},onTouchStart:function(t){return e.onButtonEvent("play",!0)},onTouchEnd:function(t){return e.onButtonEvent("play",!1)}},"Play"),r.a.createElement("button",{key:"pause",className:"player-button",id:"Pause",onMouseDown:function(t){return e.onButtonEvent("pause",!0)},onMouseUp:function(t){return e.onButtonEvent("pause",!1)},onTouchStart:function(t){return e.onButtonEvent("pause",!0)},onTouchEnd:function(t){return e.onButtonEvent("pause",!1)}},"Pause")),r.a.createElement("button",{key:"testA",className:"player-button",id:"testA",onMouseDown:function(t){return e.handleSwitchKeys("a",!0)},onMouseUp:function(t){return e.handleSwitchKeys("a",!1)},onTouchStart:function(t){return e.handleSwitchKeys("a",!0)},onTouchEnd:function(t){return e.handleSwitchKeys("a",!1)}},"A")))}}]),t}(n.Component);a(17);o.a.render(r.a.createElement(O,null),document.getElementById("root"))}},[[10,1,2]]]);
//# sourceMappingURL=main.98ff0d3e.chunk.js.map